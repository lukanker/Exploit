-- v1.1

local UIS = game:GetService('UserInputService')
local RunService = game:GetService('RunService')

local Player = game.Players.LocalPlayer
local Character = Player.Character

local Mouse = Player:GetMouse()
local Camera = workspace.CurrentCamera

local Fly = false
local FlySpeed = 130

local Controls = {
	['w'] = 0,
	['a'] = 0,
	['s'] = 0,
	['d'] = 0
}

RunService.RenderStepped:Connect(function()
	if Fly then
		Character.HumanoidRootPart.Anchored = false
		
		local BodyVelocity = Instance.new("BodyVelocity")
		BodyVelocity.Parent = Character.HumanoidRootPart
		BodyVelocity.MaxForce = Vector3.new(4000000, 4000000, 4000000)
		BodyVelocity.Name = "lukanker"
		BodyVelocity.Velocity = ((Camera.CoordinateFrame.lookVector * (Controls['w'] + -Controls['s'])) + ((Camera.CoordinateFrame * CFrame.new(-Controls['a'] + Controls['d'], (Controls['w'] + -Controls['s']) * .2, 0).Position) - Camera.CoordinateFrame.p)) * FlySpeed / 1.5
	end
end)

Mouse.KeyUp:Connect(function(key)
	if Controls[key:lower()] then
		Controls[key:lower()] = 0
	end
end)

Mouse.KeyDown:Connect(function(key)
	if Controls[key:lower()] then
		Controls[key:lower()] = 1
	end
end)

UIS.InputBegan:Connect(function(input)
	if input.KeyCode == Enum.KeyCode.F1 then
		Fly = not Fly
	end
end)
